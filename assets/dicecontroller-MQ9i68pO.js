import{O as p,C as t}from"./bsConstants-E4N5t5Rc.js";p.onReady(async()=>{const O="/dice-twenty.svg",v="/cancel.svg",T="/go.svg",m=await p.player.getName();let E={};function u(o,l){const c=document.createElement("input");c.id=o,c.type="image",c.value="0",c.src=l,c.classList.add("dice-button"),c.onclick=r=>{let a=parseInt(i.innerText);r.stopPropagation(),r.preventDefault(),a===0&&(i.hidden=!1),a<20&&(a++,i.innerText=a.toString(),E[o]=a),Object.values(E).reduce((N,R)=>N+R,0)===0?e.src=v:e.src=T},c.oncontextmenu=r=>{let a=parseInt(i.innerText);r.stopPropagation(),r.preventDefault(),a>0&&(a--,i.innerText=a.toString(),E[o]=a),a===0&&(i.hidden=!0),Object.values(E).reduce((N,R)=>N+R,0)===0?e.src=v:e.src=T};const d=document.createElement("div");d.id=o+"Container",d.classList.add("label-container");const i=document.createElement("label");return i.innerText="0",i.id=o+"Label",i.classList.add("label"),i.classList.add("dice-counter"),i.hidden=!0,d.appendChild(c),d.appendChild(i),d}const L=document.createElement("div");L.classList.add("options-container");const n=document.createElement("input");n.id="rollSelfButton",n.type="button",n.classList.add("options-button"),n.value="Self",n.dataset.active=t.FALSE,n.onclick=()=>{n.dataset.active===t.TRUE?(n.dataset.active=t.FALSE,n.classList.remove("options-active")):(n.dataset.active=t.TRUE,n.classList.add("options-active"))};const s=document.createElement("input");s.id="rollGMButton",s.type="button",s.classList.add("options-button"),s.value="GM",s.onclick=()=>{s.dataset.active===t.TRUE?(s.dataset.active=t.FALSE,s.classList.remove("options-active")):(s.dataset.active=t.TRUE,s.classList.add("options-active"))},L.appendChild(s),L.appendChild(n);const h=u("d4Button","/dice-four.svg"),S=u("d6Button","/dice-six.svg"),g=u("d8Button","/dice-eight.svg"),B=u("d10Button","/dice-ten.svg"),f=u("d12Button","/dice-twelve.svg"),I=u("d20Button","/dice-twenty.svg"),e=document.createElement("input");e.id="diceWindowOpen",e.type="image",e.src=O,e.classList.add("dice-button"),e.value=t.CLOSE,e.onclick=async()=>{if(e.value===t.CLOSE)e.src=v,e.value=t.OPEN,e.hidden=!0,await p.popover.setHeight(t.EXTENSIONDICECONTROLLERID,420),C(),e.hidden=!1,s.classList.add("options-hover"),n.classList.add("options-hover");else{const o=[];for(const[l,c]of Object.entries(E)){const d=l.replace("Button","");o.push(`${c}${d}`)}if(o.length!==0){const l=o.join("+"),c=n.dataset.active,d=s.dataset.active;let i="ALL";c==="TRUE"&&(i="SELF"),d==="TRUE"&&(i="GM");const r={},a=new Date().toISOString();r[`${t.EXTENSIONID}/metadata_bonesroll`]={notation:l,created:a,sender:m,viewers:i},await p.player.setMetadata(r)}e.src=O,e.value=t.CLOSE,C(),setTimeout(async()=>{await p.popover.setHeight(t.EXTENSIONDICECONTROLLERID,54)},500)}},e.oncontextmenu=async o=>{o.stopPropagation(),o.preventDefault(),e.value===t.OPEN&&(e.src=O,e.value=t.CLOSE,C(),setTimeout(async()=>{await p.popover.setHeight(t.EXTENSIONDICECONTROLLERID,54)},500))},t.BONESDICECONTROLLER.appendChild(L),t.BONESDICECONTROLLER.appendChild(h),t.BONESDICECONTROLLER.appendChild(S),t.BONESDICECONTROLLER.appendChild(g),t.BONESDICECONTROLLER.appendChild(B),t.BONESDICECONTROLLER.appendChild(f),t.BONESDICECONTROLLER.appendChild(I),t.BONESCONTROLLER.appendChild(e);function C(){t.BONESDICECONTROLLER.classList.contains("hidden")?(t.BONESDICECONTROLLER.classList.remove("hidden"),t.BONESDICECONTROLLER.style.height="358px"):(t.BONESDICECONTROLLER.classList.add("hidden"),t.BONESDICECONTROLLER.style.height="0",E={},D())}function D(){const o=document.querySelectorAll(".dice-counter");s.dataset.active=t.FALSE,s.classList.remove("options-active"),s.classList.remove("options-hover"),n.dataset.active=t.FALSE,n.classList.remove("options-active"),n.classList.remove("options-hover"),o.forEach(l=>{l.hidden=!0,l.innerText="0"})}});
