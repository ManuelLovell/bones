import{O as E,C as e}from"./bsConstants-mrMMLsLa.js";E.onReady(async()=>{const v="/dice-twenty.svg",C="/cancel-dice.svg",R="/go.svg",h=await E.player.getName(),m=await E.player.getId();let p={};function r(a,l,L){const d=document.createElement("input");d.id=a,d.type="image",d.value="0",d.title=L,d.src=l,d.classList.add("dice-button"),d.onclick=u=>{let o=parseInt(s.innerText);u.stopPropagation(),u.preventDefault(),o===0&&(s.hidden=!1),o<20&&(o++,s.innerText=o.toString(),p[a]=o),Object.values(p).reduce((S,T)=>S+T,0)===0?t.src=C:t.src=R},d.oncontextmenu=u=>{let o=parseInt(s.innerText);u.stopPropagation(),u.preventDefault(),o>0&&(o--,s.innerText=o.toString(),p[a]=o),o===0&&(s.hidden=!0),Object.values(p).reduce((S,T)=>S+T,0)===0?t.src=C:t.src=R};const c=document.createElement("div");c.id=a+"Container",c.classList.add("label-container");const s=document.createElement("label");return s.innerText="0",s.id=a+"Label",s.classList.add("label"),s.classList.add("dice-counter"),s.hidden=!0,c.appendChild(d),c.appendChild(s),c}const O=document.createElement("div");O.classList.add("options-container");const n=document.createElement("input");n.id="rollSelfButton",n.type="button",n.classList.add("options-button"),n.value="Self",n.dataset.active=e.FALSE,n.onclick=()=>{n.dataset.active===e.TRUE?(n.dataset.active=e.FALSE,n.classList.remove("options-active")):(n.dataset.active=e.TRUE,n.classList.add("options-active"))};const i=document.createElement("input");i.id="rollGMButton",i.type="button",i.classList.add("options-button"),i.value="GM",i.onclick=()=>{i.dataset.active===e.TRUE?(i.dataset.active=e.FALSE,i.classList.remove("options-active")):(i.dataset.active=e.TRUE,i.classList.add("options-active"))},O.appendChild(i),O.appendChild(n);const g=r("d4Button","/dice-four.svg","Add a Four-Sided Dice"),B=r("d6Button","/dice-six.svg","Add a Six-Sided Dice"),D=r("d8Button","/dice-eight.svg","Add a Eight-Sided Dice"),I=r("d10Button","/dice-ten.svg","Add a Ten-Sided Dice"),f=r("d12Button","/dice-twelve.svg","Add a Twelve-Sided Dice"),y=r("d20Button","/dice-twenty.svg","Add a Twenty-Sided Dice"),w=r("d100Button","/dice-hundred.svg","Add a Percentile and Ten-Sided Dice"),t=document.createElement("input");t.id="diceWindowOpen",t.type="image",t.src=v,t.classList.add("dice-button"),t.value=e.CLOSE,t.onclick=async()=>{if(t.value===e.CLOSE)t.src=C,t.value=e.OPEN,t.hidden=!0,await E.popover.setHeight(e.EXTENSIONDICECONTROLLERID,475),N(),t.hidden=!1,i.classList.add("options-hover"),n.classList.add("options-hover");else{const a=[];for(const[l,L]of Object.entries(p)){const d=l.replace("Button","");a.push(`${L}${d}`)}if(a.length!==0){const l=a.join("+"),L=n.dataset.active,d=i.dataset.active;let c="ALL";L==="TRUE"&&(c="SELF"),d==="TRUE"&&(c="GM");const s={},u=new Date().toISOString();s[`${e.EXTENSIONID}/metadata_bonesroll`]={notation:l,created:u,senderName:h,senderId:m,viewers:c},await E.player.setMetadata(s)}t.src=v,t.value=e.CLOSE,N(),setTimeout(async()=>{await E.popover.setHeight(e.EXTENSIONDICECONTROLLERID,54)},500)}},t.oncontextmenu=async a=>{a.stopPropagation(),a.preventDefault(),t.value===e.OPEN&&(t.src=v,t.value=e.CLOSE,N(),setTimeout(async()=>{await E.popover.setHeight(e.EXTENSIONDICECONTROLLERID,54)},500))},e.BONESDICECONTROLLER.appendChild(O),e.BONESDICECONTROLLER.appendChild(g),e.BONESDICECONTROLLER.appendChild(B),e.BONESDICECONTROLLER.appendChild(D),e.BONESDICECONTROLLER.appendChild(I),e.BONESDICECONTROLLER.appendChild(w),e.BONESDICECONTROLLER.appendChild(f),e.BONESDICECONTROLLER.appendChild(y),e.BONESCONTROLLER.appendChild(t);function N(){e.BONESDICECONTROLLER.classList.contains("hidden")?(e.BONESDICECONTROLLER.classList.remove("hidden"),e.BONESDICECONTROLLER.style.height="412px"):(e.BONESDICECONTROLLER.classList.add("hidden"),e.BONESDICECONTROLLER.style.height="0",p={},b())}function b(){const a=document.querySelectorAll(".dice-counter");i.dataset.active=e.FALSE,i.classList.remove("options-active"),i.classList.remove("options-hover"),n.dataset.active=e.FALSE,n.classList.remove("options-active"),n.classList.remove("options-hover"),a.forEach(l=>{l.hidden=!0,l.innerText="0"})}});
