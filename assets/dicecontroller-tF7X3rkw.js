import{O as u,C as t}from"./bsConstants-E4N5t5Rc.js";u.onReady(async()=>{const O="/dice-twenty.svg",v="/cancel-dice.svg",R="/go.svg",T=await u.player.getName(),h=await u.player.getId();let E={};function p(a,l){const c=document.createElement("input");c.id=a,c.type="image",c.value="0",c.src=l,c.classList.add("dice-button"),c.onclick=r=>{let o=parseInt(i.innerText);r.stopPropagation(),r.preventDefault(),o===0&&(i.hidden=!1),o<20&&(o++,i.innerText=o.toString(),E[a]=o),Object.values(E).reduce((N,m)=>N+m,0)===0?e.src=v:e.src=R},c.oncontextmenu=r=>{let o=parseInt(i.innerText);r.stopPropagation(),r.preventDefault(),o>0&&(o--,i.innerText=o.toString(),E[a]=o),o===0&&(i.hidden=!0),Object.values(E).reduce((N,m)=>N+m,0)===0?e.src=v:e.src=R};const d=document.createElement("div");d.id=a+"Container",d.classList.add("label-container");const i=document.createElement("label");return i.innerText="0",i.id=a+"Label",i.classList.add("label"),i.classList.add("dice-counter"),i.hidden=!0,d.appendChild(c),d.appendChild(i),d}const L=document.createElement("div");L.classList.add("options-container");const n=document.createElement("input");n.id="rollSelfButton",n.type="button",n.classList.add("options-button"),n.value="Self",n.dataset.active=t.FALSE,n.onclick=()=>{n.dataset.active===t.TRUE?(n.dataset.active=t.FALSE,n.classList.remove("options-active")):(n.dataset.active=t.TRUE,n.classList.add("options-active"))};const s=document.createElement("input");s.id="rollGMButton",s.type="button",s.classList.add("options-button"),s.value="GM",s.onclick=()=>{s.dataset.active===t.TRUE?(s.dataset.active=t.FALSE,s.classList.remove("options-active")):(s.dataset.active=t.TRUE,s.classList.add("options-active"))},L.appendChild(s),L.appendChild(n);const g=p("d4Button","/dice-four.svg"),S=p("d6Button","/dice-six.svg"),B=p("d8Button","/dice-eight.svg"),I=p("d10Button","/dice-ten.svg"),f=p("d12Button","/dice-twelve.svg"),D=p("d20Button","/dice-twenty.svg"),e=document.createElement("input");e.id="diceWindowOpen",e.type="image",e.src=O,e.classList.add("dice-button"),e.value=t.CLOSE,e.onclick=async()=>{if(e.value===t.CLOSE)e.src=v,e.value=t.OPEN,e.hidden=!0,await u.popover.setHeight(t.EXTENSIONDICECONTROLLERID,420),C(),e.hidden=!1,s.classList.add("options-hover"),n.classList.add("options-hover");else{const a=[];for(const[l,c]of Object.entries(E)){const d=l.replace("Button","");a.push(`${c}${d}`)}if(a.length!==0){const l=a.join("+"),c=n.dataset.active,d=s.dataset.active;let i="ALL";c==="TRUE"&&(i="SELF"),d==="TRUE"&&(i="GM");const r={},o=new Date().toISOString();r[`${t.EXTENSIONID}/metadata_bonesroll`]={notation:l,created:o,senderName:T,senderId:h,viewers:i},await u.player.setMetadata(r)}e.src=O,e.value=t.CLOSE,C(),setTimeout(async()=>{await u.popover.setHeight(t.EXTENSIONDICECONTROLLERID,54)},500)}},e.oncontextmenu=async a=>{a.stopPropagation(),a.preventDefault(),e.value===t.OPEN&&(e.src=O,e.value=t.CLOSE,C(),setTimeout(async()=>{await u.popover.setHeight(t.EXTENSIONDICECONTROLLERID,54)},500))},t.BONESDICECONTROLLER.appendChild(L),t.BONESDICECONTROLLER.appendChild(g),t.BONESDICECONTROLLER.appendChild(S),t.BONESDICECONTROLLER.appendChild(B),t.BONESDICECONTROLLER.appendChild(I),t.BONESDICECONTROLLER.appendChild(f),t.BONESDICECONTROLLER.appendChild(D),t.BONESCONTROLLER.appendChild(e);function C(){t.BONESDICECONTROLLER.classList.contains("hidden")?(t.BONESDICECONTROLLER.classList.remove("hidden"),t.BONESDICECONTROLLER.style.height="358px"):(t.BONESDICECONTROLLER.classList.add("hidden"),t.BONESDICECONTROLLER.style.height="0",E={},y())}function y(){const a=document.querySelectorAll(".dice-counter");s.dataset.active=t.FALSE,s.classList.remove("options-active"),s.classList.remove("options-hover"),n.dataset.active=t.FALSE,n.classList.remove("options-active"),n.classList.remove("options-hover"),a.forEach(l=>{l.hidden=!0,l.innerText="0"})}});
